#google reader api 介绍

= 介绍 =

在开发R2过程中总结出来的 api，虽然已经有了pyrfeed的分析在前了，但是还是有不少新的特性妹介绍的。


= 客户端认证 =
  * 这一部分是google通用的clientLogin机制
  * 请求URL:https://www.google.com/accounts/ClientLogin
  * 方法:POST
  * 参数:
    # accountType=HOSTED_OR_GOOGLE
    # Email=somebody@gmail.com
    # Passwd = youpassword
    # service=reader
    # source = clientstr (如：J-R2-1.0)
  * 返回：认证文本字符串

  * 代码示范:
   {{{

    var email = message.email;
    var passwd = message.passwd;
    var auth,sid
    var auth_params = "accountType=HOSTED_OR_GOOGLE&Email="+email+"&Passwd="+passwd+"&service=reader&source=J-MyReader-1.0";
    var http = new XMLHttpRequest()
    http.onreadystatechange = function() {
        if (http.readyState == XMLHttpRequest.DONE) {
            if(http.status==200){
                var arrs = http.responseText.split('\n')
                for(var idx in arrs){
                    var arr = arrs[idx]
                    //console.log(arr+"\n\n");
                    var tmp = arr.split('=');
                    if(tmp[0]=="Auth"){
                        auth = tmp[1];
                    }else if(tmp[0]=="SID"){
                        sid = tmp[1];
                    }
                }
            }
        }
    }
    http.open("POST", "https://www.google.com/accounts/ClientLogin");
    http.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
    http.setRequestHeader("Content-Length", auth_params.length);
    http.send( auth_params );
   }}}

